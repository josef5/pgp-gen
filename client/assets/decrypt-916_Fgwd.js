import{w,a,p as s}from"./chunk-PVWAREVJ-XSx8T8tY.js";import{u as D,L as l,B as T,T as c,o as n}from"./index.esm-Dj_4ZMYr.js";import{I as E}from"./input-CvqOa1x3.js";import{T as j}from"./textarea-B_ZhPkk4.js";function I({}){return[{title:"PGP Gen - Message Decryption"},{name:"description",content:"Message decryption tool"}]}function F(){const[i,p]=a.useState(null),[d,m]=a.useState(null),[g,u]=a.useState(!1),f=a.useRef(null),{register:o,handleSubmit:b,formState:t,reset:h}=D();async function N({encrypted:S,passphrase:x,privateKey:k}){p(null),m(null),u(!0);try{const e=await n.key.readArmored(k);x&&await e.keys[0].decrypt(x);const r=await n.message.readArmored(S),{data:C}=await n.decrypt({message:r,privateKeys:e.keys});setTimeout(()=>{var y;window.scrollTo({top:((y=f.current)==null?void 0:y.offsetTop)??0,behavior:"smooth"})},100),p(C)}catch(e){const r=e instanceof Error?e.message:String(e);console.error(r),m(`Encryption failed. ${r}`)}finally{u(!1)}}a.useEffect(()=>{t.isSubmitSuccessful&&h(void 0,{keepValues:!0})},[t.isSubmitSuccessful,h]);const v=!(t.isDirty&&t.isValid);return s.jsx("section",{children:s.jsx("form",{onSubmit:b(N),children:s.jsxs("div",{className:"mr-4 ml-4 grid max-w-[896px] grid-cols-3 md:ml-0 md:grid-cols-4",children:[s.jsx("div",{className:"col-span-full col-start-1 h-24"}),s.jsx(l,{htmlFor:"encrypted",className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"encrypted"}),s.jsx(j,{id:"encrypted",placeholder:"Paste here",className:"col-span-3 col-start-1 md:col-start-2",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",...o("encrypted",{required:!0})}),s.jsx("div",{className:"col-span-full col-start-1 h-12"}),s.jsx(l,{htmlFor:"public-key",className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"private key"}),s.jsx(j,{id:"private-key",placeholder:"Paste here",className:"col-span-3 col-start-1 md:col-start-2",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",...o("privateKey",{required:!0})}),s.jsx("div",{className:"col-span-full col-start-1 h-12"}),s.jsx(l,{htmlFor:"passphrase",className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"passphrase?"}),s.jsx(E,{id:"passphrase",type:"password",placeholder:"Type here",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",className:"col-span-3 col-start-1 md:col-start-2",...o("passphrase",{required:!1})}),s.jsx("div",{className:"col-span-full col-start-1 h-12"}),s.jsx(T,{type:"submit",className:"col-span-full md:col-start-2",disabled:v,children:"Decrypt"}),s.jsx("div",{ref:f,className:"col-span-full col-start-1 h-12"}),g&&s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"col-span-3 col-start-1 md:col-start-2",children:"Decrypting..."}),s.jsx("div",{className:"col-span-full col-start-1 h-12"})]}),d&&s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"text-foreground-error bg-background-error col-span-3 col-start-1 md:col-start-2",children:d}),s.jsx("div",{className:"col-span-full col-start-1 h-12"})]}),i&&s.jsxs(s.Fragment,{children:[s.jsx(l,{className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"decrypted"}),s.jsx(c,{className:"col-span-3 col-start-1 md:col-start-2",isCopyable:!0,children:i})]}),s.jsx("div",{className:"col-span-full col-start-1 h-12"})]})})})}const K=w(F);export{K as default,I as meta};
