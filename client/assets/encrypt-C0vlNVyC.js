import{w as v,a as t,p as s}from"./chunk-PVWAREVJ-XSx8T8tY.js";import{u as T,L as r,B as k,T as c,o}from"./index.esm-Dj_4ZMYr.js";import{T as g}from"./textarea-B_ZhPkk4.js";function P({}){return[{title:"PGP Gen - Message Encryption"},{name:"description",content:"Message encryption tool"}]}function w(){const[n,i]=t.useState(null),[m,d]=t.useState(null),[y,p]=t.useState(!1),u=t.useRef(null),{register:f,handleSubmit:b,formState:a,reset:x}=T();async function j({message:E,publicKey:S}){i(null),d(null),p(!0);try{const e=await o.key.readArmored(S),{data:l}=await o.encrypt({message:o.message.fromText(E),publicKeys:e.keys});setTimeout(()=>{var h;window.scrollTo({top:((h=u.current)==null?void 0:h.offsetTop)??0,behavior:"smooth"})},100),i(l)}catch(e){const l=e instanceof Error?e.message:String(e);console.error(l),d(`Encryption failed. ${l}`)}finally{p(!1)}}t.useEffect(()=>{a.isSubmitSuccessful&&x(void 0,{keepValues:!0})},[a.isSubmitSuccessful,x]);const N=!(a.isDirty&&a.isValid);return s.jsx("section",{children:s.jsx("form",{onSubmit:b(j),children:s.jsxs("div",{className:"mr-4 ml-4 grid max-w-[896px] grid-cols-3 md:ml-0 md:grid-cols-4",children:[s.jsx("div",{className:"col-span-full col-start-1 h-24"}),s.jsx(r,{htmlFor:"message",className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"message"}),s.jsx(g,{id:"message",placeholder:"Paste here",className:"col-span-3 col-start-1 md:col-start-2",...f("message",{required:!0})}),s.jsx("div",{className:"col-span-full col-start-1 h-12"}),s.jsx(r,{htmlFor:"public-key",className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"public key"}),s.jsx(g,{id:"public-key",placeholder:"Paste here",className:"col-span-3 col-start-1 md:col-start-2",autoCorrect:"off",autoCapitalize:"none",spellCheck:"false",...f("publicKey",{required:!0})}),s.jsx("div",{className:"col-span-full col-start-1 h-12"}),s.jsx(k,{type:"submit",className:"col-span-full md:col-start-2",disabled:N,children:"Encrypt"}),s.jsx("div",{ref:u,className:"col-span-full col-start-1 h-12"}),y&&s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"col-span-3 col-start-1 md:col-start-2",children:"Encrypting..."}),s.jsx("div",{className:"col-span-full col-start-1 h-12"})]}),m&&s.jsxs(s.Fragment,{children:[s.jsx(c,{className:"text-foreground-error bg-background-error col-span-3 col-start-1 md:col-start-2",children:m}),s.jsx("div",{className:"col-span-full col-start-1 h-12"})]}),n&&s.jsxs(s.Fragment,{children:[s.jsx(r,{className:"col-span-3 col-start-1 mb-2 md:col-span-1 md:ml-8",children:"encrypted"}),s.jsx(c,{className:"col-span-3 col-start-1 md:col-start-2",isCopyable:!0,children:n})]}),s.jsx("div",{className:"col-span-full col-start-1 h-12"})]})})})}const K=v(w);export{K as default,P as meta};
